#!/bin/bash
# create-and-remove-test.sh - —Å–æ–∑–¥–∞–µ–º —Ç–µ—Å—Ç–æ–≤—ã–π –¥–æ–∫—É–º–µ–Ω—Ç –∏ —É–¥–∞–ª—è–µ–º –±–ª–æ–∫

echo "=== –°–û–ó–î–ê–ù–ò–ï –ò –£–î–ê–õ–ï–ù–ò–ï –¢–ï–°–¢–û–í–û–ì–û –î–û–ö–£–ú–ï–ù–¢–ê ==="
echo "–î–∞—Ç–∞: $(date)"
echo ""

cd /Users/kirillkravcov/obsidian/my-digital-garden-content/uch-docs || exit 1

# 1. –°–û–ó–î–ê–ï–ú –¢–ï–°–¢–û–í–´–ô –î–û–ö–£–ú–ï–ù–¢
TEST_FILE="04-07 - –¢–µ—Å—Ç–æ–≤—ã–π –¥–æ–∫—É–º–µ–Ω—Ç.md"

echo "üìù –°–æ–∑–¥–∞—é —Ç–µ—Å—Ç–æ–≤—ã–π –¥–æ–∫—É–º–µ–Ω—Ç: $TEST_FILE"
echo ""

cat > "$TEST_FILE" << 'EOF'
---
id: "04-07"
name: "–¢–µ—Å—Ç–æ–≤—ã–π –¥–æ–∫—É–º–µ–Ω—Ç"
type: "test"
level: 2
status: "active"
tags: ["test", "experiment"]
created: "2026-01-03"
updated: "2026-01-03"
author: "system"
slug: "04-07-test-document"
---

# üìã –¢–ï–°–¢–û–í–´–ô –î–û–ö–£–ú–ï–ù–¢

## üìñ –í–í–ï–î–ï–ù–ò–ï

–≠—Ç–æ —Ç–µ—Å—Ç–æ–≤—ã–π –¥–æ–∫—É–º–µ–Ω—Ç –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —É–¥–∞–ª–µ–Ω–∏—è –±–ª–æ–∫–∞ "–û–±—â–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è".

### üéØ –¶–ï–õ–¨ –¢–ï–°–¢–ê

–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç—É —Å–∫—Ä–∏–ø—Ç–∞ —É–¥–∞–ª–µ–Ω–∏—è.

#### –û–ë–©–ê–Ø –ò–ù–§–û–†–ú–ê–¶–ò–Ø

- **ID**: `04-07`
- **–£—Ä–æ–≤–µ–Ω—å**: 2
- **–°—Ç–∞—Ç—É—Å**: –¢–µ—Å—Ç–æ–≤—ã–π
- **–°–æ–∑–¥–∞–Ω**: 2026-01-03
- **–¢–µ–≥–∏**: test, experiment

–≠—Ç–æ –±–ª–æ–∫ –æ–±—â–µ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –∫–æ—Ç–æ—Ä—ã–π –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —É–¥–∞–ª–µ–Ω.

#### –û–ü–ò–°–ê–ù–ò–ï

–ü–æ—Å–ª–µ —É–¥–∞–ª–µ–Ω–∏—è –±–ª–æ–∫–∞ "–û–±—â–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è" –∑–¥–µ—Å—å –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –≤–∏–¥–Ω–æ –æ–ø–∏—Å–∞–Ω–∏–µ.

#### –†–ï–ó–£–õ–¨–¢–ê–¢–´

–ó–¥–µ—Å—å –±—É–¥—É—Ç –ø–æ–∫–∞–∑–∞–Ω—ã —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∞.

### üìä –í–´–í–û–î–´

–í—ã–≤–æ–¥—ã –ø–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è.

## üèÅ –ó–ê–ö–õ–Æ–ß–ï–ù–ò–ï

–¢–µ—Å—Ç –∑–∞–≤–µ—Ä—à–µ–Ω.
EOF

echo "‚úÖ –î–æ–∫—É–º–µ–Ω—Ç —Å–æ–∑–¥–∞–Ω"
echo ""

# 2. –ü–û–ö–ê–ó–´–í–ê–ï–ú –ß–¢–û –°–û–ó–î–ê–õ–ò
echo "üîç –°–æ–¥–µ—Ä–∂–∏–º–æ–µ —Å–æ–∑–¥–∞–Ω–Ω–æ–≥–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞:"
echo "-----------------------------------"
head -40 "$TEST_FILE"
echo ""

# 3. –ü–û–ö–ê–ó–´–í–ê–ï–ú –ë–õ–û–ö "–û–ë–©–ê–Ø –ò–ù–§–û–†–ú–ê–¶–ò–Ø"
echo "üìå –ë–ª–æ–∫ '–û–±—â–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è' –≤ –¥–æ–∫—É–º–µ–Ω—Ç–µ:"
echo "--------------------------------------"
grep -n -i "–æ–±—â–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è" "$TEST_FILE"
echo ""

# 4. –£–î–ê–õ–Ø–ï–ú –ë–õ–û–ö –ü–†–û–°–¢–´–ú –°–ü–û–°–û–ë–û–ú
echo "üîß –£–î–ê–õ–Ø–ï–ú –ë–õ–û–ö '–û–ë–©–ê–Ø –ò–ù–§–û–†–ú–ê–¶–ò–Ø'"
echo "---------------------------------"

# –ù–∞—Ö–æ–¥–∏–º —Å—Ç—Ä–æ–∫—É —Å –∑–∞–≥–æ–ª–æ–≤–∫–æ–º
HEADER_LINE=$(grep -n "^#### –û–ë–©–ê–Ø –ò–ù–§–û–†–ú–ê–¶–ò–Ø" "$TEST_FILE" | cut -d: -f1)

if [ -z "$HEADER_LINE" ]; then
    echo "‚ùå –ó–∞–≥–æ–ª–æ–≤–æ–∫ '#### –û–ë–©–ê–Ø –ò–ù–§–û–†–ú–ê–¶–ò–Ø' –Ω–µ –Ω–∞–π–¥–µ–Ω"
    exit 1
fi

echo "–ó–∞–≥–æ–ª–æ–≤–æ–∫ –Ω–∞–π–¥–µ–Ω –Ω–∞ —Å—Ç—Ä–æ–∫–µ: $HEADER_LINE"

# –ù–∞—Ö–æ–¥–∏–º —Å–ª–µ–¥—É—é—â–∏–π –∑–∞–≥–æ–ª–æ–≤–æ–∫ ####, ### –∏–ª–∏ ##
NEXT_HEADER_LINE=""
TOTAL_LINES=$(wc -l < "$TEST_FILE")

for ((i=HEADER_LINE+1; i<=TOTAL_LINES; i++)); do
    LINE_CONTENT=$(sed -n "${i}p" "$TEST_FILE")
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º —è–≤–ª—è–µ—Ç—Å—è –ª–∏ —Å—Ç—Ä–æ–∫–∞ –∑–∞–≥–æ–ª–æ–≤–∫–æ–º
    if [[ "$LINE_CONTENT" =~ ^####\  ]] || [[ "$LINE_CONTENT" =~ ^###\  ]] || [[ "$LINE_CONTENT" =~ ^##\  ]]; then
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ —ç—Ç–æ –Ω–µ —Ç–æ—Ç –∂–µ –∑–∞–≥–æ–ª–æ–≤–æ–∫
        if [[ ! "$LINE_CONTENT" =~ –û–ë–©–ê–Ø\ –ò–ù–§–û–†–ú–ê–¶–ò–Ø ]]; then
            NEXT_HEADER_LINE=$i
            break
        fi
    fi
done

if [ -z "$NEXT_HEADER_LINE" ]; then
    echo "‚ùå –°–ª–µ–¥—É—é—â–∏–π –∑–∞–≥–æ–ª–æ–≤–æ–∫ –Ω–µ –Ω–∞–π–¥–µ–Ω"
    exit 1
fi

echo "–°–ª–µ–¥—É—é—â–∏–π –∑–∞–≥–æ–ª–æ–≤–æ–∫ –Ω–∞ —Å—Ç—Ä–æ–∫–µ: $NEXT_HEADER_LINE"
echo "–ë—É–¥–µ—Ç —É–¥–∞–ª–µ–Ω–æ —Å—Ç—Ä–æ–∫: $((NEXT_HEADER_LINE - HEADER_LINE))"
echo ""

# –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —á—Ç–æ –±—É–¥–µ—Ç —É–¥–∞–ª–µ–Ω–æ
echo "üìã –°–æ–¥–µ—Ä–∂–∏–º–æ–µ –±–ª–æ–∫–∞ –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç —É–¥–∞–ª–µ–Ω:"
sed -n "${HEADER_LINE},$((NEXT_HEADER_LINE - 1))p" "$TEST_FILE" | cat -n
echo ""

# 5. –£–î–ê–õ–Ø–ï–ú –ë–õ–û–ö
echo "üöÄ –í–´–ü–û–õ–ù–Ø–Æ –£–î–ê–õ–ï–ù–ò–ï..."
sed -i '' "${HEADER_LINE},$((NEXT_HEADER_LINE - 1))d" "$TEST_FILE"
echo "‚úÖ –£–î–ê–õ–ï–ù–û!"
echo ""

# 6. –ü–û–ö–ê–ó–´–í–ê–ï–ú –†–ï–ó–£–õ–¨–¢–ê–¢
echo "üîç –†–ï–ó–£–õ–¨–¢–ê–¢ –ü–û–°–õ–ï –£–î–ê–õ–ï–ù–ò–Ø:"
echo "---------------------------"

# –ü—Ä–æ–≤–µ—Ä—è–µ–º –æ—Å—Ç–∞–ª—Å—è –ª–∏ –±–ª–æ–∫
echo "–ü–æ–∏—Å–∫ '–û–±—â–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è' –≤ –¥–æ–∫—É–º–µ–Ω—Ç–µ:"
grep -n -i "–æ–±—â–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è" "$TEST_FILE" 2>/dev/null && echo "‚ùå –ë–ª–æ–∫ –û–°–¢–ê–õ–°–Ø" || echo "‚úÖ –ë–ª–æ–∫ –£–î–ê–õ–ï–ù"
echo ""

# –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –¥–æ–∫—É–º–µ–Ω—Ç –ø–æ—Å–ª–µ —É–¥–∞–ª–µ–Ω–∏—è
echo "üìÑ –î–æ–∫—É–º–µ–Ω—Ç –ø–æ—Å–ª–µ —É–¥–∞–ª–µ–Ω–∏—è (—Å—Ç—Ä–æ–∫–∏ –≤–æ–∫—Ä—É–≥ —É–¥–∞–ª–µ–Ω–Ω–æ–≥–æ –±–ª–æ–∫–∞):"
echo ""

# –ü–æ–∫–∞–∂–µ–º —Å—Ç—Ä–æ–∫–∏ –¥–æ –∏ –ø–æ—Å–ª–µ —É–¥–∞–ª–µ–Ω–Ω–æ–≥–æ –±–ª–æ–∫–∞
SHOW_START=$((HEADER_LINE - 5))
if [ $SHOW_START -lt 1 ]; then
    SHOW_START=1
fi

SHOW_END=$((HEADER_LINE + 5))
sed -n "${SHOW_START},${SHOW_END}p" "$TEST_FILE" | cat -n

echo ""
echo "üìä –°–¢–ê–¢–ò–°–¢–ò–ö–ê:"
echo "  –ò—Å—Ö–æ–¥–Ω—ã–π —Ä–∞–∑–º–µ—Ä: $TOTAL_LINES —Å—Ç—Ä–æ–∫"
echo "  –ù–æ–≤—ã–π —Ä–∞–∑–º–µ—Ä: $(wc -l < "$TEST_FILE") —Å—Ç—Ä–æ–∫"
echo "  –£–¥–∞–ª–µ–Ω–æ —Å—Ç—Ä–æ–∫: $((TOTAL_LINES - $(wc -l < "$TEST_FILE")))"
echo ""

# 7. –ü–û–ö–ê–ó–´–í–ê–ï–ú –°–¢–†–£–ö–¢–£–†–£ –î–û–ö–£–ú–ï–ù–¢–ê
echo "üèóÔ∏è –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞ –ø–æ—Å–ª–µ —É–¥–∞–ª–µ–Ω–∏—è:"
grep -n "^#\+" "$TEST_FILE" | head -10

echo ""
echo "‚úÖ –¢–ï–°–¢ –ó–ê–í–ï–†–®–ï–ù"
echo "üìÅ –¢–µ—Å—Ç–æ–≤—ã–π –¥–æ–∫—É–º–µ–Ω—Ç: $TEST_FILE"
echo "üí° –î–æ–∫—É–º–µ–Ω—Ç –ù–ï –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –≤ –∏—Å—Ö–æ–¥–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ!"