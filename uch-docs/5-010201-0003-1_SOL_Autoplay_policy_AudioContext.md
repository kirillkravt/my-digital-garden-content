---
id: "5-010201-0003"
name: "Autoplay policy AudioContext"
type: "SOL"
level: 5
status: "active"
tags: []
created: "2026-01-02"
updated: "2026-01-28"
author: "kirillkravcov"
slug: "5-010201-0003-1_SOL_Autoplay_policy_AudioContext"
---


## üéØ –û–ü–ò–°–ê–ù–ò–ï –ü–†–û–ë–õ–ï–ú–´

### –ß–¢–û –ü–†–û–ò–°–•–û–î–ò–¢:
AudioContext –æ—Å—Ç–∞–µ—Ç—Å—è –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ `suspended` –ø–æ—Å–ª–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ Strudel. –ó–≤—É–∫ –Ω–µ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—Å—è –±–µ–∑ —è–≤–Ω–æ–≥–æ user gesture (–∫–ª–∏–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è).

### –ö–û–ù–¢–ï–ö–°–¢:
- –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –±—Ä–∞—É–∑–µ—Ä—ã –±–ª–æ–∫–∏—Ä—É—é—Ç –∞–≤—Ç–æ–≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –∑–≤—É–∫–∞
- –¢—Ä–µ–±—É–µ—Ç—Å—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–ª—è –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ AudioContext
- –ü—Ä–æ–±–ª–µ–º–∞ –∑–∞—Ç—Ä–∞–≥–∏–≤–∞–µ—Ç –≤—Å–µ –∞—É–¥–∏–æ-–∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã UCH

## üîç –î–ò–ê–ì–ù–û–°–¢–ò–ö–ê

### –¢–ï–ö–£–©–ï–ï –°–û–°–¢–û–Ø–ù–ò–ï:
javascript
// –ü–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã:
const audioContext = window.strudel.getAudioContext();
console.log(audioContext.state); // "suspended"

// –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–æ–ª–∂–µ–Ω –∫–ª–∏–∫–Ω—É—Ç—å —á—Ç–æ–±—ã:
audioContext.resume().then(() => {
  console.log(audioContext.state); // "running"
});

### –ü–û–í–ï–î–ï–ù–ò–ï –ë–†–ê–£–ó–ï–†–û–í:

- **Chrome**: –ë–ª–æ–∫–∏—Ä—É–µ—Ç autoplay –±–µ–∑ user gesture
    
- **Firefox**: –ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ
    
- **Safari**: –°–∞–º—ã–µ —Å—Ç—Ä–æ–≥–∏–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è
    
- **Edge**: –ü–æ—Ö–æ–∂–µ –Ω–∞ Chrome
    

## ‚ö†Ô∏è –°–ò–ú–ü–¢–û–ú–´

### –í UCH:

1. Strudel –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è, –Ω–æ –∑–≤—É–∫–∞ –Ω–µ—Ç
    
2. –ö–Ω–æ–ø–∫–∞ Play –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∫–ª–∏–∫–µ
    
3. –¢—Ä–µ–±—É–µ—Ç—Å—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –∫–ª–∏–∫ –¥–ª—è –∞–∫—Ç–∏–≤–∞—Ü–∏–∏
    
4. –í –∫–æ–Ω—Å–æ–ª–∏:¬†`The AudioContext was not allowed to start`
    

### –í –õ–û–ì–ê–•:

text

‚úÖ Strudel initialized with WebAudio...
‚ö†Ô∏è AudioContext state: suspended
‚ùå Playback failed: AudioContext is not running

## üí° –†–ï–®–ï–ù–ò–Ø –ò –ü–û–î–•–û–î–´

### –†–ï–®–ï–ù–ò–ï 1: –ö–ù–û–ü–ö–ê –ê–ö–¢–ò–í–ê–¶–ò–ò

typescript

// –Ø–≤–Ω–∞—è –∫–Ω–æ–ø–∫–∞ "–†–∞–∑—Ä–µ—à–∏—Ç—å –∑–≤—É–∫"
<button onClick={activateAudio}>
  üîà –†–∞–∑—Ä–µ—à–∏—Ç—å –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –∑–≤—É–∫–∞
</button>

const activateAudio = async () => {
  await audioContext.resume();
  setAudioActivated(true);
};

### –†–ï–®–ï–ù–ò–ï 2: –ê–í–¢–û–ú–ê–¢–ò–ß–ï–°–ö–ê–Ø –ê–ö–¢–ò–í–ê–¶–ò–Ø –ü–†–ò –í–ó–ê–ò–ú–û–î–ï–ô–°–¢–í–ò–ò

typescript

// –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–∏ –ª—é–±–æ–º –∫–ª–∏–∫–µ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏
document.addEventListener('click', async () => {
  if (audioContext.state === 'suspended') {
    await audioContext.resume();
  }
}, { once: true }); // –¢–æ–ª—å–∫–æ –ø–µ—Ä–≤—ã–π –∫–ª–∏–∫

### –†–ï–®–ï–ù–ò–ï 3: –ò–ù–¢–ï–†–ê–ö–¢–ò–í–ù–´–ô –ó–ê–ì–†–£–ó–ß–ò–ö

- –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å overlay —Å –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ–º
    
- –¢—Ä–µ–±–æ–≤–∞—Ç—å –∫–ª–∏–∫ –¥–ª—è –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è
    
- –°–æ—Ö—Ä–∞–Ω—è—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ –≤ localStorage
    

### –†–ï–®–ï–ù–ò–ï 4: –î–ï–§–ï–†–†–ò–†–û–í–ê–ù–ù–ê–Ø –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø

- –ù–µ —Å–æ–∑–¥–∞–≤–∞—Ç—å AudioContext –¥–æ –∫–ª–∏–∫–∞
    
- –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å Strudel —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏
    

## üìã –ü–õ–ê–ù –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø

### –≠–¢–ê–ü 1: –ù–ï–ú–ï–î–õ–ï–ù–ù–´–ô FIX (–°–ï–ì–û–î–ù–Ø)

1. –î–æ–±–∞–≤–∏—Ç—å –∫–Ω–æ–ø–∫—É –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ –≤ StrudelREPLNode
    
2. –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ AudioContext –≤ UI
    
3. –ë–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –∫–Ω–æ–ø–∫—É Play –¥–æ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏
    

### –≠–¢–ê–ü 2: –£–õ–£–ß–®–ï–ù–ò–ï UX (1-2 –î–ù–Ø)

1. –°–æ–∑–¥–∞—Ç—å –≥–ª–æ–±–∞–ª—å–Ω—ã–π AudioContext –º–µ–Ω–µ–¥–∂–µ—Ä
    
2. –ï–¥–∏–Ω–∞—è —Ç–æ—á–∫–∞ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ –¥–ª—è –≤—Å–µ–≥–æ UCH
    
3. –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –º–µ–∂–¥—É —Å–µ—Å—Å–∏—è–º–∏
    

### –≠–¢–ê–ü 3: –ü–†–û–ê–ö–¢–ò–í–ù–û–ï –†–ï–®–ï–ù–ò–ï (–ù–ï–î–ï–õ–Ø)

1. –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –∑–∞–≥—Ä—É–∑—á–∏–∫ —Å –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ–º
    
2. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∞–∫—Ç–∏–≤–∞—Ü–∏—è –ø—Ä–∏ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–∏
    
3. –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –≤—Å–µ—Ö –±—Ä–∞—É–∑–µ—Ä–æ–≤
    

## üõ†Ô∏è –¢–ï–•–ù–ò–ß–ï–°–ö–ê–Ø –†–ï–ê–õ–ò–ó–ê–¶–ò–Ø

### –ö–û–ú–ü–û–ù–ï–ù–¢ AudioActivator:

typescript

// –ì–ª–æ–±–∞–ª—å–Ω—ã–π —Å–µ—Ä–≤–∏—Å –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è AudioContext
class AudioActivator {
  private static instance: AudioActivator;
  private audioContext: AudioContext | null = null;
  
  static getInstance() {
    if (!AudioActivator.instance) {
      AudioActivator.instance = new AudioActivator();
    }
    return AudioActivator.instance;
  }
  
  async activate() {
    if (!this.audioContext) {
      this.audioContext = new AudioContext();
    }
    
    if (this.audioContext.state === 'suspended') {
      await this.audioContext.resume();
      return true;
    }
    return false;
  }
  
  getContext() {
    return this.audioContext;
  }
}

### –ò–ù–¢–ï–ì–†–ê–¶–ò–Ø –í StrudelREPLNode:

typescript

// –í –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–µ:
const [audioActivated, setAudioActivated] = useState(false);

useEffect(() => {
  const activator = AudioActivator.getInstance();
  const context = activator.getContext();
  
  // –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –∫–æ–Ω—Ç–µ–∫—Å—Ç –∏–ª–∏ —Å–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π
  if (context) {
    window.strudel.init({ audioContext: context });
  }
}, []);

## üîó –°–í–Ø–ó–ê–ù–ù–´–ï –î–û–ö–£–ú–ï–ù–¢–´

### –†–û–î–ò–¢–ï–õ–¨–°–ö–ò–ï:

- [[10 02-10 epic - Strudel –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è]]
    
- [[06 line - –°—Ç—É–¥–∏—è]]
    

### –°–ú–ï–ñ–ù–´–ï –ü–†–û–ë–õ–ï–ú–´:

- [[13 02-10-03 task - –ü—Ä–æ–±–ª–µ–º–∞ —Å —Å–µ–º–ø–ª–∞–º–∏]]
    
- [[00-02-04-01 - –ì–ª–æ–±–∞–ª—å–Ω–∞—è –∞—É–¥–∏–æ —Å–∏—Å—Ç–µ–º–∞]]
    

### –†–ï–®–ï–ù–ò–Ø:

- [[05-–†–ï–®–ï–ù–ò–Ø/AudioContext activation patterns]]
    

### –°–¢–ê–ù–î–ê–†–¢–´:

- [Web Audio Autoplay Policy](https://developer.chrome.com/blog/autoplay/)
    

## üìä –ú–ï–¢–†–ò–ö–ò –ò –ü–†–ò–û–†–ò–¢–ï–¢

### –í–õ–ò–Ø–ù–ò–ï:

- **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏**: –í—Å–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ UCH
    
- **–°–µ—Ä—å–µ–∑–Ω–æ—Å—Ç—å**: –í—ã—Å–æ–∫–∞—è (–±–ª–æ–∫–∏—Ä—É–µ—Ç –æ—Å–Ω–æ–≤–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é)
    
- **–ß–∞—Å—Ç–æ—Ç–∞**: 100% —Å–ª—É—á–∞–µ–≤
    

### –ü–†–ò–û–†–ò–¢–ï–¢:

- **–í–∞–∂–Ω–æ—Å—Ç—å**: üî¥ –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è
    
- **–°—Ä–æ—á–Ω–æ—Å—Ç—å**: –í—ã—Å–æ–∫–∞—è
    
- **–°–ª–æ–∂–Ω–æ—Å—Ç—å**: –ù–∏–∑–∫–∞—è/–°—Ä–µ–¥–Ω—è—è
    

### –ü–†–û–ì–†–ï–°–°:

- **–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞**: 100%
    
- **–†–µ—à–µ–Ω–∏–µ**: 50%
    
- **–†–µ–∞–ª–∏–∑–∞—Ü–∏—è**: 0%
    
- **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**: 0%
    

## üéØ –ö–†–ò–¢–ï–†–ò–ò –£–°–ü–ï–•–ê

### –¢–ï–•–ù–ò–ß–ï–°–ö–ò–ï:

1. AudioContext –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç—Å—è –∑–∞ 1 –∫–ª–∏–∫
    
2. –°–æ—Å—Ç–æ—è–Ω–∏–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –º–µ–∂–¥—É –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞–º–∏
    
3. –†–∞–±–æ—Ç–∞–µ—Ç –≤–æ –≤—Å–µ—Ö –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã—Ö –±—Ä–∞—É–∑–µ—Ä–∞—Ö
    

### UX:

1. –ü–æ–Ω—è—Ç–Ω–æ–µ –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
    
2. –ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–µ–π—Å—Ç–≤–∏–π
    
3. –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ confusion (–Ω–µ–ø–æ–Ω—è—Ç–æ–∫)
    

### –ü–†–û–ò–ó–í–û–î–ò–¢–ï–õ–¨–ù–û–°–¢–¨:

1. –ù–µ—Ç –∑–∞–¥–µ—Ä–∂–µ–∫ –ø—Ä–∏ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏
    
2. –ü–∞–º—è—Ç—å –Ω–µ —Ç–µ—á–µ—Ç
    
3. –ù–µ –≤–ª–∏—è–µ—Ç –Ω–∞ –¥—Ä—É–≥–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
    

---

*–°–æ–∑–¥–∞–Ω–æ: 2025-12-25*  
_–°—Ç–∞—Ç—É—Å: –û—Ç–∫—Ä—ã—Ç–æ_  
_–ë–ª–æ–∫–∏—Ä—É–µ—Ç: –í–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –∑–≤—É–∫–∞ –≤ UCH_  
_–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π_  
_–ë—Ä–∞—É–∑–µ—Ä—ã: Chrome, Firefox, Safari, Edge_
